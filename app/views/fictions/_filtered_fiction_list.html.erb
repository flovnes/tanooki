<section id="filtered-fictions" class="mb-8">
  <div class="flex flex-col lg:flex-row justify-between items-start lg:items-center mb-4">
    <div class="font-semibold text-stone-800 dark:text-gray-100 mb-2 lg:mb-0">
      <span class="relative z-10 inline-block group text-xl lg:text-2xl">
        <%= sample_genre.name %>
      </span>
    </div>
    <%= link_to alphabetical_fictions_path, class: "inline-flex text-sm lg:text-base text-stone-700 dark:text-gray-300 hover:text-stone-800 hover:underline dark:hover:text-gray-100" do %>
      Всі Твори
      <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 12H5m14 0-4 4m4-4-4-4"/>
      </svg>
    <% end %>
  </div>

  <div class="flex flex-wrap gap-2 mb-4 pb-2 justify-center sm:justify-start">
    <% genres.each do |genre| %>
      <%= turbo_frame_tag 'fiction-filters' do %>
        <%= simple_form_for fictions_path, method: :get, data: { turbo_stream: "" } do |f| %>
          <%= hidden_field_tag :genre_id, genre.id %>
          <%= tag.div class: "inline-block relative no-underline focus:outline-1 focus:outline-dashed" do %>
            <%= f.submit genre.name,
                  class: "hover:cursor-pointer px-2 lg:px-3 py-1 rounded-md text-xs font-semibold shadow-sm ring-1 transition duration-300 whitespace-nowrap
                    " +
                    (genre == sample_genre ?
                      "bg-stone-700 dark:bg-gray-600 text-white ring-stone-700 dark:ring-gray-600 scale-105" :
                      "bg-stone-200 dark:bg-gray-700 text-stone-700 dark:text-gray-300 ring-stone-100 dark:ring-gray-600 hover:bg-stone-300 dark:hover:bg-gray-600 hover:ring-stone-300 dark:hover:ring-gray-500 hover:scale-105")
                %>
          <% end %>
        <% end %>
      <% end %>
    <% end %>
  </div>

  <div class="grid grid-cols-4 lg:grid-cols-4 gap-3 lg:gap-4">
    <% fictions.each do |fiction| %>
      <div class="">
        <%= link_to fiction_path(fiction), class: '' do %>
          <%= image_tag url_for(fiction.cover),
            alt: fiction.cover.blob.filename.to_s,
            class: "w-full aspect-[2/3] object-cover rounded-md shadow-sm mb-2 transition duration-300 transform hover:scale-105 opacity-0",
            loading: "lazy",
            data: {
              controller: "lazy-image",
              lazy_image_target: "image",
              lazy_image_url_value: url_for(fiction.cover)
            } %>
        <% end %>
        <div class="flex justify-center">
          <%= link_to fiction_path(fiction), class: 'group' do %>
            <h3 class="text-base font-semibold text-stone-800 dark:text-gray-200 line-clamp-1 group-hover:text-stone-600 dark:group-hover:text-gray-400 transition-colors duration-300">
              <%= fiction.title %>
            </h3>
          <% end %>
        </div>
      </div>
    <% end %>
  </div>
</section>
