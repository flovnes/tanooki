<div class="z-10 relative">
  <div id="chapters-accordion-collapse-body"
      class="space-y-6 bg-white shadow-lg rounded-xl p-6 border border-gray-200"
      aria-labelledby="chapters-accordion-collapse-heading"
      data-controller="flowbite">

    <% if chapters.any? %>
      <ul class="space-y-4">
        <% chapters.each do |chapter| %>
          <li class="bg-gray-50 hover:bg-gray-100 transition-all duration-300 p-4 rounded-lg shadow-sm border border-gray-200">
            <div class="flex justify-between items-center">
              <div class="flex-1 min-w-0">
                <%= tag.p chapter.display_title, class: 'text-lg font-semibold text-gray-900 truncate' %>
                <div class="flex items-center space-x-4 mt-1 text-gray-600 text-sm">
                  <span class="flex items-center space-x-1">
                    <%= tag.span l(chapter.created_at, format: :short).downcase %>
                  </span>
                  <span class="flex items-center space-x-1">
                    <%= image_tag 'comment.svg', class: 'h-4 w-4', alt: 'comments' %>
                    <%= tag.span chapter.comments_count %>
                  </span>
                  <span class="flex items-center space-x-1">
                    <%= image_tag 'eye.svg', class: 'h-4 w-4', alt: 'views' %>
                    <%= tag.span chapter.views %>
                  </span>
                </div>
              </div>
              <%= render 'users/dashboard/chapter_controls', chapter: chapter, fiction:, page: pagy.page %>
            </div>
          </li>
        <% end %>
      </ul>

      <div class="flex flex-col sm:flex-row justify-between items-center mt-6 space-y-4 sm:space-y-0 sm:space-x-4">
        <% if pagy.pages > 1 %>
          <div class="pagy-nav w-full sm:w-auto">
            <%== pagy_nav(pagy) %>
          </div>
        <% end %>
        <%= link_to "Додати Розділ", new_chapter_path(fiction:),
              data: { turbo: false },
              class: 'inline-flex items-center justify-center px-6 py-3 text-white bg-emerald-700 hover:bg-emerald-800 transition-all duration-300 rounded-lg shadow-md font-medium' %>
      </div>

    <% else %>
      <div class="text-center py-10">
        <p class="text-gray-500 text-lg font-light">
          Ця історія ще не має розділів! Виправте це,
          <%= link_to 'додавши перший!', new_chapter_path(fiction:),
                data: { turbo: false },
                class: 'text-emerald-600 hover:underline font-medium' %>
        </p>
      </div>
    <% end %>
  </div>
</div>